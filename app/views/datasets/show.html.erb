<% content_for:head do%>

  
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/fixedcolumns/3.3.2/js/dataTables.fixedColumns.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedcolumns/3.3.2/css/fixedColumns.dataTables.min.css">
  <%= javascript_pack_tag "datatable" %>
<%end%>
<% content_for :title, @dataset.name %>

<div class="container">
    <h1>
        <%= @dataset.name %>
    </h1>
    <p>
        <span class="download_span">
            Download sample information:
            <%= link_to "download metadata", download_ds_metadata_user_dataset_path %>
        </span>
        <span class="download_span">
            Download sample infiltration:
            <%= link_to "download infiltration", download_ds_inf_user_dataset_path %>
        </span>
    </p>
    <h2>Samples</h2>


    <div id='hidden_helper'>
        <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownAttributes" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Click to view hidden columns:
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownAttributes">
            <% i=2 %>
            <% @sample_attrs.each do |attr| %>
            <% if attr != 'id' %>
                <% if !@vis.include? attr %>
                <% attr = attr.gsub(/^n_/, "") %>
                <% attr = attr.gsub(/^c_/, "") %>
                <div class = "dropdown-item">
                    <input id = <%= attr %> type= "checkbox" class="toggle-vis" data-column='<%=i.to_s%>'>  
                    <label for= <%= attr %> > <%= attr %></label>
                </div>
                <% end %>
                <%i += 1%>
            <% end %>
            <%end%>
        </div>
        </div>
    </div>
    <br />

    <%= form_tag delete_sample_user_dataset_path, multipart: true do %>  
        <%= content_tag :table, role: :datatable, class: "display", id: "table_page", data: { url: user_dataset_path(format: :json)} do %>
            <thead>
                <th>
                    <input type="checkbox" class="selectAll" name="selectAll" value="all">
                </th>
                <% @sample_attrs.each do |attr| %>
                    <% attr = attr.gsub(/^n_/, "") %>
                    <% attr = attr.gsub(/^c_/, "") %>
                    <th> <%= attr %> </th>
                    
                <% end %>
                <th>Action</th>
            </thead>
            <tbody>
            </tbody>
        <% end %>

    <%= submit_tag "delete selected samples from dataset", :name => 'delete_sample', :class => "s_table_sub" %>
    <%end%>

    <p>
        <%#= form_tag upload_file_user_dataset_path, :multipart =>true do %>
            <%#= file_field_tag :file %>
            <%#= submit_tag "upload new file" %>
        <%# end %> 
        <%= link_to 'Delete dataset', [@dataset.user, @dataset], method: :delete,
        data: { comfirm: 'Are you sure to delete this dataset?'} %>
        <br />
        <%= link_to 'Change dataset name', edit_user_dataset_path(@dataset.user, @dataset.id) %> 
        <br />
        <%= link_to 'Go to add data', samples_path %> 
    </p>
</div>